---
layout: default
title: Арифметическое кодирование. Геометрический подход.
---


# Арифметическое кодирование. Геометрический подход.

## Вложенные отрезки

Рассмотрим систему волженных отрезков, которые используются в арифметическом кодировании.

Идентификация


Имеется отрезок $$[0, 1)$$. У нас есть другой отрезок $$T$$ длины $$p$$, который
находится внутри исходного отрезка. Если нам будет известна точка внутри $$T$$,
то по ней возможно восстановить сам $$T$$. Оценим, сколько бит надо, чтобы
запомнить точку из отрезка $$T$$. Заметим, что важна лишь длина этого отрезка,
не важно в какой части $$[0, 1)$$ он находится. В результате получаем, что
требуется:

$$
   \log_2{\frac{1}{p}}
$$

Получается это из следующих соображений. Нужно найти отрезок, который был бы
вложен в $$T$$. Очевидно, его длина меньше или равна $$p$$. Будем разбивать
исходный отрезок на $$2^k$$ частей. Нужно сделать так, чтобы размер каждой части
$$\frac{1}{2^k}$$ не превысил $$p$$. Поэтому:

$$
   \frac{1}{2^k} \leq p
$$

Откуда получается, что

$$
   k \geq \log_2{\frac{1}{p}}
$$

Понятно, что количество разбиений -- $$k$$ -- это целое число, поэтому

$$
   k = \lceil \log_2{\frac{1}{p}} \rceil
$$

Максимизация

Допустим, у нас есть сообщение, в котором *ноль* встречается $$m$$ раз, а
*единица* $$n$$ раз. Построим систему вложенных отрезков, согласно конструкции.
Нас интересует длинна последнего получившегося отрезка после $$n + m$$ шагов.
Допустим, что каждый отрезок мы делили в отношении $$\alpha : \beta$$,
где $$\alpha + \beta = 1$$. Тогда длина последнего отрезка:

$$
   \alpha^n \beta^m
$$

При каком значении $$\alpha$$ и $$\beta$$ длина отрезка достигает максимума?
На самом деле, мы имеем дело с функцией от одной переменной:

$$
   f(\alpha) = \alpha^n {(1 - \alpha)}^m
$$

Найдем все значения $$alpha$$, при которых $$f(\alpha)$$ максимальна. Для этого
вычислим производую и приравняем к нулю:

$$
   f'(\alpha) = \alpha^{n-1}(1 - \alpha)^{m-1}[n - \alpha(n + m)]
$$

Получаем три корня, из которых интересен только один:

$$
   \alpha = \frac{n}{n + m}
$$

Автоматически:

$$
   \beta = 1 - \alpha = \frac{m}{n + m}
$$

В итоге получили, что отрезок нужно делить в отношении $$n:m$$, а $$\alpha$$ и
$$\beta$$ - это соответсвенно вероятности появления нуля и единицы.
